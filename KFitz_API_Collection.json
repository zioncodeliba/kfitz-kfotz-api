{
  "info": {
    "_postman_id": "kfitz-api-collection",
    "name": "KFitz API Collection",
    "description": "Up-to-date API collection for KFitz Backend including role-based helpers and latest endpoints.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{auth_token}}",
        "type": "string"
      }
    ]
  },
  "item": [
    {
      "name": "Authentication",
      "item": [
        {
          "name": "Register",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/register",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "register"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Test User\",\n  \"email\": \"new.user@example.com\",\n  \"password\": \"Password123!\",\n  \"password_confirmation\": \"Password123!\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          }
        },
        {
          "name": "Login (custom credentials)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/login",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "login"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"password\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "const data = json && json.data ? json.data : {};",
                  "const token = data.token;",
                  "pm.test('Token received', function () {",
                  "    pm.expect(token, 'token').to.exist;",
                  "});",
                  "if (token) {",
                  "    pm.collectionVariables.set('auth_token', token);",
                  "    pm.collectionVariables.set('active_role', 'custom');",
                  "}",
                  "if (data.user && data.user.id) {",
                  "    pm.collectionVariables.set('last_user_id', data.user.id.toString());",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Login as Admin",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/login",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "login"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{admin_email}}\",\n  \"password\": \"{{admin_password}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "const data = json && json.data ? json.data : {};",
                  "const token = data.token;",
                  "pm.test('Token received', function () {",
                  "    pm.expect(token, 'token').to.exist;",
                  "});",
                  "if (token) {",
                  "    pm.collectionVariables.set('auth_token', token);",
                  "    pm.collectionVariables.set('admin_token', token);",
                  "    pm.collectionVariables.set('active_role', 'admin');",
                  "}",
                  "if (data.user && data.user.id) {",
                  "    pm.collectionVariables.set('last_user_id', data.user.id.toString());",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Login as Agent",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/login",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "login"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{agent_email}}\",\n  \"password\": \"{{agent_password}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "const data = json && json.data ? json.data : {};",
                  "const token = data.token;",
                  "pm.test('Token received', function () {",
                  "    pm.expect(token, 'token').to.exist;",
                  "});",
                  "if (token) {",
                  "    pm.collectionVariables.set('auth_token', token);",
                  "    pm.collectionVariables.set('agent_token', token);",
                  "    pm.collectionVariables.set('active_role', 'agent');",
                  "}",
                  "if (data.user && data.user.id) {",
                  "    pm.collectionVariables.set('last_user_id', data.user.id.toString());",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Login as Merchant",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/login",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "login"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{merchant_email}}\",\n  \"password\": \"{{merchant_password}}\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "const data = json && json.data ? json.data : {};",
                  "const token = data.token;",
                  "pm.test('Token received', function () {",
                  "    pm.expect(token, 'token').to.exist;",
                  "});",
                  "if (token) {",
                  "    pm.collectionVariables.set('auth_token', token);",
                  "    pm.collectionVariables.set('merchant_token', token);",
                  "    pm.collectionVariables.set('active_role', 'merchant');",
                  "}",
                  "if (data.user && data.user.id) {",
                  "    pm.collectionVariables.set('last_user_id', data.user.id.toString());",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/logout",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "logout"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    pm.collectionVariables.unset('auth_token');",
                  "    pm.collectionVariables.set('active_role', '');",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Use stored Admin token",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/me",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "me"
              ]
            }
          },
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const storedToken = pm.collectionVariables.get('admin_token');",
                  "pm.test('Token available for role', function () {",
                  "    pm.expect(storedToken, 'stored token').to.exist;",
                  "});",
                  "pm.collectionVariables.set('auth_token', storedToken);",
                  "pm.collectionVariables.set('active_role', 'admin');"
                ]
              }
            }
          ]
        },
        {
          "name": "Use stored Agent token",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/me",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "me"
              ]
            }
          },
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const storedToken = pm.collectionVariables.get('agent_token');",
                  "pm.test('Token available for role', function () {",
                  "    pm.expect(storedToken, 'stored token').to.exist;",
                  "});",
                  "pm.collectionVariables.set('auth_token', storedToken);",
                  "pm.collectionVariables.set('active_role', 'agent');"
                ]
              }
            }
          ]
        },
        {
          "name": "Use stored Merchant token",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/me",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "me"
              ]
            }
          },
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const storedToken = pm.collectionVariables.get('merchant_token');",
                  "pm.test('Token available for role', function () {",
                  "    pm.expect(storedToken, 'stored token').to.exist;",
                  "});",
                  "pm.collectionVariables.set('auth_token', storedToken);",
                  "pm.collectionVariables.set('active_role', 'merchant');"
                ]
              }
            }
          ]
        },
        {
          "name": "Use manual token value",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/me",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "me"
              ]
            }
          },
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const manualToken = pm.collectionVariables.get('manual_token') || pm.environment.get('manual_token');",
                  "pm.test('Manual token available', function () {",
                  "    pm.expect(manualToken, 'manual token').to.exist;",
                  "});",
                  "pm.collectionVariables.set('auth_token', manualToken);",
                  "pm.collectionVariables.set('active_role', 'manual');"
                ]
              }
            }
          ]
        },
        {
          "name": "Me",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/me",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "me"
              ]
            }
          }
        },
        {
          "name": "Forgot password",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/forgot-password",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "forgot-password"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          }
        },
        {
          "name": "Reset password",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/reset-password",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "reset-password"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"token\": \"{{password_reset_token}}\",\n  \"email\": \"user@example.com\",\n  \"password\": \"NewPassword123!\",\n  \"password_confirmation\": \"NewPassword123!\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          }
        }
      ]
    },
    {
      "name": "Email Verification",
      "item": [
        {
          "name": "Resend verification email",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/email/verification-notification",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "email",
                "verification-notification"
              ]
            }
          }
        },
        {
          "name": "Verification status",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/email/verification-status",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "email",
                "verification-status"
              ]
            }
          }
        },
        {
          "name": "Verify via signed URL",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/email/verify/{{user_id}}/{{verification_hash}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "email",
                "verify",
                "{{user_id}}",
                "{{verification_hash}}"
              ]
            }
          }
        },
        {
          "name": "Frontend verify",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/verify-email",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "verify-email"
              ],
              "query": [
                {
                  "key": "id",
                  "value": "{{user_id}}"
                },
                {
                  "key": "hash",
                  "value": "{{verification_hash}}"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Public Catalog",
      "item": [
        {
          "name": "List categories",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/categories",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "categories"
              ]
            }
          }
        },
        {
          "name": "Category tree",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/categories/tree",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "categories",
                "tree"
              ]
            }
          }
        },
        {
          "name": "Get category",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/categories/{{category_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "categories",
                "{{category_id}}"
              ]
            }
          }
        },
        {
          "name": "List products",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/products",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "products"
              ]
            }
          }
        },
        {
          "name": "Featured products",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/products/featured",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "products",
                "featured"
              ]
            }
          }
        },
        {
          "name": "Get product",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/products/{{product_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "products",
                "{{product_id}}"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test('Response contains product data', function () {",
                  "    pm.expect(json).to.have.property('data');",
                  "});",
                  "const product = json.data || {};",
                  "pm.test('Product includes variations snapshot', function () {",
                  "    pm.expect(product).to.have.property('variations');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Low stock products",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/products/low-stock",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "products",
                "low-stock"
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Public Shipping & Tools",
      "item": [
        {
          "name": "Active shipping carriers",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/shipping-carriers/active",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "shipping-carriers",
                "active"
              ]
            }
          }
        },
        {
          "name": "Calculate carrier cost (public)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/shipping-carriers/{{shipping_carrier_id}}/calculate-cost",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "shipping-carriers",
                "{{shipping_carrier_id}}",
                "calculate-cost"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"weight\": 2.5,\n  \"service_type\": \"regular\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          }
        },
        {
          "name": "Calculate shipping cost (public)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/orders/calculate-shipping-cost",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "orders",
                "calculate-shipping-cost"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"carrier_id\": \"{{shipping_carrier_id}}\",\n  \"service_type\": \"regular\",\n  \"weight\": 2.5\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          }
        },
        {
          "name": "Track shipment (public)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/shipments/track/{{tracking_number}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "shipments",
                "track",
                "{{tracking_number}}"
              ]
            }
          }
        },
        {
          "name": "Serve product image",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/product-images/{{image_path}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "product-images",
                "{{image_path}}"
              ]
            }
          },
          "description": "Replace {{image_path}} with the relative image path, e.g. products/sample.jpg"
        }
      ]
    },
    {
      "name": "Orders",
      "item": [
        {
          "name": "List orders",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/orders",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "orders"
              ]
            }
          }
        },
        {
          "name": "Open orders",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/orders/open",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "orders",
                "open"
              ]
            }
          }
        },
        {
          "name": "Waiting for shipment",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/orders/waiting-shipment",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "orders",
                "waiting-shipment"
              ]
            }
          }
        },
        {
          "name": "Closed orders",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/orders/closed",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "orders",
                "closed"
              ]
            }
          }
        },
        {
          "name": "Create order",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/orders",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "orders"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"merchant_id\": \"{{merchant_id}}\",\n  \"merchant_customer_id\": \"{{merchant_customer_id}}\",\n  \"shipping_type\": \"delivery\",\n  \"shipping_method\": \"regular\",\n  \"shipping_cost\": 29.9,\n  \"billing_address\": {\n    \"name\": \"רות כהן\",\n    \"phone\": \"+972500000000\",\n    \"street\": \"הרצל 12\",\n    \"city\": \"פתח תקווה\",\n    \"zip\": \"49300\",\n    \"country\": \"IL\"\n  },\n  \"shipping_address\": {\n    \"name\": \"רות כהן\",\n    \"phone\": \"+972500000000\",\n    \"street\": \"תובל 32\",\n    \"city\": \"רמת גן\",\n    \"zip\": \"52522\",\n    \"country\": \"IL\",\n    \"notes\": \"לתאם מסירה מראש\"\n  },\n  \"items\": [\n    {\n      \"product_id\": \"{{product_id}}\",\n      \"variation_id\": \"{{product_variation_id}}\",\n      \"quantity\": 1\n    },\n    {\n      \"product_id\": \"{{secondary_product_id}}\",\n      \"variation_id\": \"{{secondary_product_variation_id}}\",\n      \"quantity\": 2\n    }\n  ],\n  \"notes\": \"הזמנת בדיקה מפוסטמן\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          }
        },
        {
          "name": "Create order (missing variation - expect 422)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/orders",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "orders"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"merchant_id\": \"{{merchant_id}}\",\n  \"merchant_customer_id\": \"{{merchant_customer_id}}\",\n  \"shipping_type\": \"delivery\",\n  \"shipping_method\": \"regular\",\n  \"shipping_cost\": 29.9,\n  \"billing_address\": {\n    \"name\": \"רות כהן\",\n    \"phone\": \"+972500000000\",\n    \"street\": \"הרצל 12\",\n    \"city\": \"פתח תקווה\",\n    \"zip\": \"49300\",\n    \"country\": \"IL\"\n  },\n  \"shipping_address\": {\n    \"name\": \"רות כהן\",\n    \"phone\": \"+972500000000\",\n    \"street\": \"תובל 32\",\n    \"city\": \"רמת גן\",\n    \"zip\": \"52522\",\n    \"country\": \"IL\"\n  },\n  \"items\": [\n    {\n      \"product_id\": \"{{variant_product_id}}\",\n      \"quantity\": 1\n    }\n  ],\n  \"notes\": \"ניסון: חוסר \\u05d0\\u05d7\\u05d3 \\u05e6\\u05e8\\u05d9\\u05da\\u05e9\\u05dc\\u05d9\\u05d1\\u05d3\\u05d5\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Returns 422 when variation missing', function () {",
                  "    pm.response.to.have.status(422);",
                  "});",
                  "const body = pm.response.json();",
                  "const message = (body && body.message ? body.message : '').toLowerCase();",
                  "pm.test('Error message mentions variation', function () {",
                  "    pm.expect(message).to.include('variation');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get order",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/orders/{{order_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "orders",
                "{{order_id}}"
              ]
            }
          }
        },
        {
          "name": "Update order",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/orders/{{order_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "orders",
                "{{order_id}}"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"processing\",\n  \"payment_status\": \"pending\",\n  \"notes\": \"עדכון סטטוס הזמנה לבדיקה\",\n  \"shipping_address\": {\n    \"name\": \"רות כהן\",\n    \"phone\": \"+972500000000\",\n    \"street\": \"תובל 32\",\n    \"city\": \"רמת גן\",\n    \"zip\": \"52522\",\n    \"country\": \"IL\",\n    \"notes\": \"לתאם מסירה מראש\"\n  },\n  \"billing_address\": {\n    \"name\": \"רות כהן\",\n    \"phone\": \"+972500000000\",\n    \"street\": \"הרצל 12\",\n    \"city\": \"פתח תקווה\",\n    \"zip\": \"49300\",\n    \"country\": \"IL\"\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          }
        },
        {
          "name": "Delete order",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/orders/{{order_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "orders",
                "{{order_id}}"
              ]
            }
          }
        },
        {
          "name": "Orders by status",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/orders/status/{{order_status}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "orders",
                "status",
                "{{order_status}}"
              ]
            }
          }
        },
        {
          "name": "Dashboard stats",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/orders/dashboard/stats",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "orders",
                "dashboard",
                "stats"
              ]
            }
          }
        },
        {
          "name": "Sales performance",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/orders/dashboard/sales-performance",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "orders",
                "dashboard",
                "sales-performance"
              ],
              "query": [
                {
                  "key": "range",
                  "value": "last_week"
                }
              ]
            }
          }
        },
        {
          "name": "Assign carrier to order",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/orders/{{order_id}}/assign-carrier",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "orders",
                "{{order_id}}",
                "assign-carrier"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"carrier_id\": \"{{shipping_carrier_id}}\",\n  \"service_type\": \"regular\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          }
        },
        {
          "name": "Available carriers for order",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/orders/{{order_id}}/available-carriers",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "orders",
                "{{order_id}}",
                "available-carriers"
              ]
            }
          }
        },
        {
          "name": "Get order shipping settings",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/orders/{{order_id}}/shipping-settings",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "orders",
                "{{order_id}}",
                "shipping-settings"
              ]
            }
          }
        },
        {
          "name": "Update order shipping settings",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/orders/{{order_id}}/shipping-settings",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "orders",
                "{{order_id}}",
                "shipping-settings"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"delivery_window\": \"09:00-14:00\",\n  \"requires_signature\": true,\n  \"leave_at_door\": false,\n  \"pickup_point\": null,\n  \"comments\": \"נא להתקשר 30 דקות לפני הגעה\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          }
        },
        {
          "name": "Calculate order shipping cost",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/orders/{{order_id}}/calculate-shipping-cost",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "orders",
                "{{order_id}}",
                "calculate-shipping-cost"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"carrier_id\": \"{{shipping_carrier_id}}\",\n  \"service_type\": \"regular\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          }
        }
      ]
    },
    {
      "name": "Shipments",
      "item": [
        {
          "name": "List shipments",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/shipments",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "shipments"
              ]
            }
          }
        },
        {
          "name": "Create shipment",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/shipments",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "shipments"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"order_id\": \"{{order_id}}\",\n  \"carrier_id\": \"{{shipping_carrier_id}}\",\n  \"tracking_number\": \"TRACK12345\",\n  \"status\": \"pending\",\n  \"weight\": 2.6,\n  \"length\": 30,\n  \"width\": 20,\n  \"height\": 15,\n  \"notes\": \"משלוח בדיקה - חולצות בייבי\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          }
        },
        {
          "name": "Get shipment",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/shipments/{{shipment_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "shipments",
                "{{shipment_id}}"
              ]
            }
          }
        },
        {
          "name": "Update shipment",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/shipments/{{shipment_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "shipments",
                "{{shipment_id}}"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"shipped\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          }
        },
        {
          "name": "Delete shipment",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/shipments/{{shipment_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "shipments",
                "{{shipment_id}}"
              ]
            }
          }
        },
        {
          "name": "Shipments by status",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/shipments/status/{{shipment_status}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "shipments",
                "status",
                "{{shipment_status}}"
              ]
            }
          }
        },
        {
          "name": "Add tracking event",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/shipments/{{shipment_id}}/tracking-events",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "shipments",
                "{{shipment_id}}",
                "tracking-events"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"in_transit\",\n  \"location\": \"מרכז לוגיסטי, תל אביב\",\n  \"details\": \"המשלוח מוין ונשלח להפצה\",\n  \"occurred_at\": \"2024-11-01T10:30:00+02:00\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          }
        }
      ]
    },
    {
      "name": "Merchant",
      "item": [
        {
          "name": "Merchant profile",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/merchant/profile",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "merchant",
                "profile"
              ]
            }
          }
        },
        {
          "name": "Update merchant profile",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/merchant/profile",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "merchant",
                "profile"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"business_name\": \"Merchant LTD\",\n  \"business_id\": \"123456789\",\n  \"phone\": \"+97251000000\",\n  \"website\": \"https://merchant.example.com\",\n  \"description\": \"חנות לדוגמה לשליחת בדיקות\",\n  \"address\": {\n    \"name\": \"רות כהן\",\n    \"company\": \"חברת לקוח בע\\\"מ\",\n    \"phone\": \"+972500000000\",\n    \"street\": \"דרך השלום 45\",\n    \"city\": \"תל אביב\",\n    \"zip\": \"61000\",\n    \"country\": \"IL\"\n  },\n  \"shipping_address\": {\n    \"name\": \"רות כהן\",\n    \"phone\": \"+972500000000\",\n    \"street\": \"תובל 32\",\n    \"city\": \"רמת גן\",\n    \"zip\": \"52522\",\n    \"country\": \"IL\",\n    \"notes\": \"לתאם מסירה מראש\"\n  },\n  \"bank_details\": {\n    \"bank_name\": \"הפועלים\",\n    \"branch_number\": \"123\",\n    \"account_number\": \"456789\",\n    \"account_name\": \"Merchant LTD\"\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          }
        },
        {
          "name": "Merchant dashboard",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/merchant/dashboard",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "merchant",
                "dashboard"
              ]
            }
          }
        },
        {
          "name": "Merchant customers",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/merchant/customers",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "merchant",
                "customers"
              ]
            }
          }
        },
        {
          "name": "Get merchant customer",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/merchant/customers/{{customer_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "merchant",
                "customers",
                "{{customer_id}}"
              ]
            }
          }
        },
        {
          "name": "Update merchant customer",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/merchant/customers/{{customer_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "merchant",
                "customers",
                "{{customer_id}}"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Updated Customer\",\n  \"phone\": \"+972520000000\",\n  \"notes\": \"מעדיף מסירה בבוקר\",\n  \"address\": {\n    \"name\": \"רות כהן\",\n    \"phone\": \"+972500000000\",\n    \"street\": \"תובל 32\",\n    \"city\": \"רמת גן\",\n    \"zip\": \"52522\",\n    \"country\": \"IL\",\n    \"notes\": \"לתאם מסירה מראש\"\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          }
        },
        {
          "name": "Plugin order (merchant portal)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/plugin/orders",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "plugin",
                "orders"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"site_url\": \"{{plugin_site_url}}\",\n  \"order_number\": \"PLUGIN-{{plugin_order_number}}\",\n  \"total\": 399.7,\n  \"items\": [\n    {\n      \"product_id\": \"{{product_id}}\",\n      \"variation_id\": \"{{product_variation_id}}\",\n      \"quantity\": 1\n    },\n    {\n      \"product_id\": \"{{secondary_product_id}}\",\n      \"variation_id\": \"{{secondary_product_variation_id}}\",\n      \"quantity\": 2\n    }\n  ],\n  \"customer\": {\n    \"name\": \"נועם הלקוח\",\n    \"email\": \"customer@example.com\",\n    \"phone\": \"+972500000000\",\n    \"address\": {\n      \"line1\": \"תובל 32\",\n      \"city\": \"רמת גן\",\n      \"state\": \"מחוז תל אביב\",\n      \"zip\": \"52522\",\n      \"country\": \"IL\"\n    },\n    \"notes\": \"לקוח חוזר מהחנות המקוונת\"\n  },\n  \"source\": \"shopify\",\n  \"status\": \"paid\",\n  \"shipping\": {\n    \"type\": \"delivery\",\n    \"method\": \"standard\",\n    \"cost\": 0\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          }
        },
        {
          "name": "Plugin order (missing variation - expect 422)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/plugin/orders",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "plugin",
                "orders"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"site_url\": \"{{plugin_site_url}}\",\n  \"order_number\": \"MISSING-VAR-{{plugin_order_number}}\",\n  \"total\": 199.9,\n  \"items\": [\n    {\n      \"product_id\": \"{{variant_product_id}}\",\n      \"quantity\": 1\n    }\n  ],\n  \"customer\": {\n    \"name\": \"מבחן פלאגין\",\n    \"email\": \"customer@example.com\",\n    \"phone\": \"+972500000000\",\n    \"address\": {\n      \"line1\": \"תובל 12\",\n      \"city\": \"תל אביב\",\n      \"state\": \"המש ה\",\n      \"zip\": \"12345\",\n      \"country\": \"IL\"\n    }\n  }\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "pm.test('Returns 422 when plugin variation missing', function () {",
                  "    pm.response.to.have.status(422);",
                  "});",
                  "const body = pm.response.json();",
                  "const message = (body && body.message ? body.message : '').toLowerCase();",
                  "pm.test('Error mentions variation', function () {",
                  "    pm.expect(message).to.include('variation');",
                  "});"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Admin",
      "item": [
        {
          "name": "Dashboard",
          "item": [
            {
              "name": "Admin dashboard ping",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/admin/dashboard",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "admin",
                    "dashboard"
                  ]
                }
              }
            },
            {
              "name": "Dashboard alerts",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/admin/dashboard/alerts",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "admin",
                    "dashboard",
                    "alerts"
                  ]
                }
              }
            },
            {
              "name": "Orders summary",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/admin/orders/summary",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "admin",
                    "orders",
                    "summary"
                  ]
                }
              }
            }
          ]
        },
        {
          "name": "Users",
          "item": [
            {
              "name": "List users",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/users",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "users"
                  ]
                }
              }
            },
            {
              "name": "Create user",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/users",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "users"
                  ]
                },
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"name\": \"New User\",\n  \"email\": \"new.user@example.com\",\n  \"password\": \"Password123!\",\n  \"role\": \"merchant\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                }
              }
            },
            {
              "name": "Get user",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/users/{{user_id}}",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "users",
                    "{{user_id}}"
                  ]
                }
              }
            },
            {
              "name": "Update user",
              "request": {
                "method": "PUT",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/users/{{user_id}}",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "users",
                    "{{user_id}}"
                  ]
                },
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"name\": \"Updated Name\",\n  \"phone\": \"+972530000000\",\n  \"notes\": \"עודכן מפוסטמן לבדיקה\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                }
              }
            },
            {
              "name": "Delete user",
              "request": {
                "method": "DELETE",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/users/{{user_id}}",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "users",
                    "{{user_id}}"
                  ]
                }
              }
            }
          ]
        },
        {
          "name": "Categories",
          "item": [
            {
              "name": "Create category",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/categories",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "categories"
                  ]
                },
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"name\": \"New Category\",\n  \"description\": \"קטגוריה לדוגמה לבדיקה\",\n  \"is_active\": true\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                }
              }
            },
            {
              "name": "Update category",
              "request": {
                "method": "PUT",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/categories/{{category_id}}",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "categories",
                    "{{category_id}}"
                  ]
                },
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"name\": \"Updated Category\",\n  \"description\": \"עדכון קטגוריה מפוסטמן\",\n  \"is_active\": true\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                }
              }
            },
            {
              "name": "Delete category",
              "request": {
                "method": "DELETE",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/categories/{{category_id}}",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "categories",
                    "{{category_id}}"
                  ]
                }
              }
            }
          ]
        },
        {
          "name": "Products",
          "item": [
            {
              "name": "Create product",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/products",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "products"
                  ]
                },
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"name\": \"New Product\",\n  \"sku\": \"SKU-001\",\n  \"price\": 199.9,\n  \"stock_quantity\": 10,\n  \"category_id\": \"{{category_id}}\",\n  \"description\": \"מוצר חדש לבדיקה\",\n  \"status\": \"active\",\n  \"weight\": 1.5,\n  \"tax_rate\": 0.17\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                }
              }
            },
            {
              "name": "Update product",
              "request": {
                "method": "PUT",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/products/{{product_id}}",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "products",
                    "{{product_id}}"
                  ]
                },
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"name\": \"Updated Product\",\n  \"price\": 149.9,\n  \"stock_quantity\": 8,\n  \"status\": \"draft\",\n  \"weight\": 1.35\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                }
              }
            },
            {
              "name": "Delete product",
              "request": {
                "method": "DELETE",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/products/{{product_id}}",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "products",
                    "{{product_id}}"
                  ]
                }
              }
            },
            {
              "name": "Upload product image",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "multipart/form-data"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/product-images",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "product-images"
                  ]
                },
                "body": {
                  "mode": "formdata",
                  "formdata": [
                    {
                      "key": "image",
                      "type": "file",
                      "src": [
                        "/absolute/path/to/image.jpg"
                      ]
                    }
                  ]
                }
              },
              "description": "Update the file path before sending."
            },
            {
              "name": "Sync Cashcow Inventory",
              "request": {
                "method": "POST",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/admin/products/sync-inventory",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "admin",
                    "products",
                    "sync-inventory"
                  ]
                }
              },
              "response": []
            }
          ]
        },
        {
          "name": "Merchants",
          "item": [
            {
              "name": "List merchants",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/merchants",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "merchants"
                  ]
                }
              }
            },
            {
              "name": "Create merchant",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/merchants",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "merchants"
                  ]
                },
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"business_name\": \"Merchant Ltd\",\n  \"business_id\": \"987654321\",\n  \"phone\": \"+972540000000\",\n  \"status\": \"active\",\n  \"address\": {\n    \"name\": \"רות כהן\",\n    \"company\": \"חברת לקוח בע\\\"מ\",\n    \"phone\": \"+972500000000\",\n    \"street\": \"דרך השלום 45\",\n    \"city\": \"תל אביב\",\n    \"zip\": \"61000\",\n    \"country\": \"IL\"\n  },\n  \"shipping_address\": {\n    \"name\": \"רות כהן\",\n    \"phone\": \"+972500000000\",\n    \"street\": \"תובל 32\",\n    \"city\": \"רמת גן\",\n    \"zip\": \"52522\",\n    \"country\": \"IL\",\n    \"notes\": \"לתאם מסירה מראש\"\n  }\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                }
              }
            },
            {
              "name": "Get merchant",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/merchants/{{merchant_id}}",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "merchants",
                    "{{merchant_id}}"
                  ]
                }
              }
            },
            {
              "name": "Update merchant",
              "request": {
                "method": "PUT",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/merchants/{{merchant_id}}",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "merchants",
                    "{{merchant_id}}"
                  ]
                },
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"status\": \"suspended\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                }
              }
            },
            {
              "name": "Delete merchant",
              "request": {
                "method": "DELETE",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/merchants/{{merchant_id}}",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "merchants",
                    "{{merchant_id}}"
                  ]
                }
              }
            }
          ]
        },
        {
          "name": "Shipping",
          "item": [
            {
              "name": "List carriers",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/shipping-carriers",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "shipping-carriers"
                  ]
                }
              }
            },
            {
              "name": "Create carrier",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/shipping-carriers",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "shipping-carriers"
                  ]
                },
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"name\": \"Speedy Express\",\n  \"code\": \"SPEEDY\",\n  \"description\": \"חברת משלוחים מהירה לבדיקה\",\n  \"api_url\": \"https://carrier.example.com/api\",\n  \"api_key\": \"test-key\",\n  \"api_secret\": \"test-secret\",\n  \"base_rate\": 25,\n  \"rate_per_kg\": 9.9,\n  \"service_types\": [\n    \"regular\",\n    \"express\"\n  ],\n  \"is_active\": true,\n  \"is_test_mode\": true\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                }
              }
            },
            {
              "name": "Get carrier",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/shipping-carriers/{{shipping_carrier_id}}",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "shipping-carriers",
                    "{{shipping_carrier_id}}"
                  ]
                }
              }
            },
            {
              "name": "Update carrier",
              "request": {
                "method": "PUT",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/shipping-carriers/{{shipping_carrier_id}}",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "shipping-carriers",
                    "{{shipping_carrier_id}}"
                  ]
                },
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"is_active\": false\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                }
              }
            },
            {
              "name": "Delete carrier",
              "request": {
                "method": "DELETE",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/shipping-carriers/{{shipping_carrier_id}}",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "shipping-carriers",
                    "{{shipping_carrier_id}}"
                  ]
                }
              }
            },
            {
              "name": "Carrier stats",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/shipping-carriers/stats",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "shipping-carriers",
                    "stats"
                  ]
                }
              }
            },
            {
              "name": "Test carrier connection",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/shipping-carriers/{{shipping_carrier_id}}/test-connection",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "shipping-carriers",
                    "{{shipping_carrier_id}}",
                    "test-connection"
                  ]
                }
              }
            },
            {
              "name": "Admin calculate carrier cost",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/shipping-carriers/{{shipping_carrier_id}}/calculate-cost",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "shipping-carriers",
                    "{{shipping_carrier_id}}",
                    "calculate-cost"
                  ]
                },
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"weight\": 3.2,\n  \"service_type\": \"express\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                }
              }
            },
            {
              "name": "Get merchant shipping settings",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/api/merchant/shipping-settings",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "merchant",
                    "shipping-settings"
                  ]
                }
              }
            },
            {
              "name": "Update merchant shipping settings",
              "request": {
                "method": "PUT",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/merchant/shipping-settings",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "merchant",
                    "shipping-settings"
                  ]
                },
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"default_carrier_id\": \"{{shipping_carrier_id}}\",\n  \"allow_express\": true,\n  \"allow_pickup\": false,\n  \"handling_time_hours\": 24,\n  \"default_service_type\": \"regular\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                }
              }
            }
          ]
        },
        {
          "name": "Plugin Sites",
          "item": [
            {
              "name": "List plugin sites",
              "request": {
                "method": "GET",
                "header": [
                  {
                    "key": "Accept",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/plugin-sites",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "plugin-sites"
                  ]
                }
              }
            },
            {
              "name": "Create plugin site",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  },
                  {
                    "key": "Accept",
                    "value": "application/json"
                  }
                ],
                "url": {
                  "raw": "{{base_url}}/api/plugin-sites",
                  "host": [
                    "{{base_url}}"
                  ],
                  "path": [
                    "api",
                    "plugin-sites"
                  ]
                },
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"name\": \"Shopify Store\",\n  \"site_url\": \"https://shop.example.com\",\n  \"platform\": \"shopify\",\n  \"status\": \"active\",\n  \"merchant_id\": \"{{merchant_id}}\",\n  \"api_key\": \"shopify-api-key\",\n  \"api_secret\": \"shopify-secret\"\n}",
                  "options": {
                    "raw": {
                      "language": "json"
                    }
                  }
                }
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Plugin Integrations",
      "description": "Helpers for plugin store integrations: authentication, plugin site creation, product sync and order import.",
      "item": [
        {
          "name": "Plugin Login (merchant credentials)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/login",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "login"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"{{merchant_email}}\",\n  \"password\": \"{{merchant_password}}\"\n}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "const json = pm.response.json();",
                  "const data = json && json.data ? json.data : {};",
                  "const token = data.token;",
                  "pm.test('Token received', function () {",
                  "    pm.expect(token, 'token').to.exist;",
                  "});",
                  "if (token) {",
                  "    pm.collectionVariables.set('auth_token', token);",
                  "    pm.collectionVariables.set('active_role', 'merchant');",
                  "}",
                  "if (data.user && data.user.id) {",
                  "    pm.collectionVariables.set('last_user_id', data.user.id.toString());",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Plugin Verify Session (/api/me)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/me",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "me"
              ]
            }
          }
        },
        {
          "name": "Plugin Site - Create",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/plugin-sites",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "plugin-sites"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"site_url\": \"{{plugin_site_url}}\",\n  \"name\": \"Default FB Shop\",\n  \"platform\": \"wordpress\",\n  \"contact_name\": \"Marketplace Admin\",\n  \"contact_phone\": \"+972520000000\"\n}"
            }
          }
        },
        {
          "name": "Plugin Categories - List",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/plugin/categories?site_url={{plugin_site_url}}&with_products_only=true",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "plugin",
                "categories"
              ],
              "query": [
                {
                  "key": "site_url",
                  "value": "{{plugin_site_url}}"
                },
                {
                  "key": "with_products_only",
                  "value": "true"
                }
              ]
            }
          }
        },
        {
          "name": "Plugin Categories - Show",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/plugin/categories/{{plugin_category_id}}?site_url={{plugin_site_url}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "plugin",
                "categories",
                "{{plugin_category_id}}"
              ],
              "query": [
                {
                  "key": "site_url",
                  "value": "{{plugin_site_url}}"
                }
              ]
            }
          }
        },
        {
          "name": "Plugin Products - List",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/plugin/products?site_url={{plugin_site_url}}&category_id={{plugin_category_id}}&per_page=50",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "plugin",
                "products"
              ],
              "query": [
                {
                  "key": "site_url",
                  "value": "{{plugin_site_url}}"
                },
                {
                  "key": "category_id",
                  "value": "{{plugin_category_id}}"
                },
                {
                  "key": "per_page",
                  "value": "50"
                }
              ]
            }
          }
        },
        {
          "name": "Plugin Products - Show",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/plugin/products/{{product_id}}?site_url={{plugin_site_url}}&category_id={{plugin_category_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "plugin",
                "products",
                "{{product_id}}"
              ],
              "query": [
                {
                  "key": "site_url",
                  "value": "{{plugin_site_url}}"
                },
                {
                  "key": "category_id",
                  "value": "{{plugin_category_id}}"
                }
              ]
            }
          }
        },
        {
          "name": "Plugin Products - Inventory Snapshot",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/plugin/products/inventory?site_url={{plugin_site_url}}&category_id={{plugin_category_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "plugin",
                "products",
                "inventory"
              ],
              "query": [
                {
                  "key": "site_url",
                  "value": "{{plugin_site_url}}"
                },
                {
                  "key": "category_id",
                  "value": "{{plugin_category_id}}"
                }
              ]
            }
          }
        },
        {
          "name": "Plugin Products - Single Inventory",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/plugin/products/{{product_id}}/inventory?site_url={{plugin_site_url}}&category_id={{plugin_category_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "plugin",
                "products",
                "{{product_id}}",
                "inventory"
              ],
              "query": [
                {
                  "key": "site_url",
                  "value": "{{plugin_site_url}}"
                },
                {
                  "key": "category_id",
                  "value": "{{plugin_category_id}}"
                }
              ]
            }
          }
        },
        {
          "name": "Plugin Order - Create",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/plugin/orders",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "plugin",
                "orders"
              ]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"site_url\": \"{{plugin_site_url}}\",\n  \"external_id\": \"WP-ORDER-{{plugin_order_number}}\",\n  \"customer\": {\n    \"name\": \"WordPress Buyer\",\n    \"phone\": \"+972501234567\",\n    \"email\": \"buyer@example.com\",\n    \"address\": {\n      \"line1\": \"Herzl 5\",\n      \"city\": \"Tel Aviv\",\n      \"zip\": \"61000\",\n      \"country\": \"IL\"\n    }\n  },\n  \"items\": [\n    {\n      \"product_id\": \"{{product_id}}\",\n      \"variation_id\": \"{{product_variation_id}}\",\n      \"quantity\": 1\n    }\n  ],\n  \"totals\": {\n    \"subtotal\": 199.9,\n    \"tax\": 34.0,\n    \"shipping_cost\": 20,\n    \"discount\": 0,\n    \"total\": 253.9\n  },\n  \"shipping\": {\n    \"method\": \"delivery\",\n    \"type\": \"regular\",\n    \"cost\": 20\n  },\n  \"notes\": \"Imported from plugin demo\"\n}"
            }
          }
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8000",
      "type": "string"
    },
    {
      "key": "auth_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "active_role",
      "value": "",
      "type": "string"
    },
    {
      "key": "admin_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "agent_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "manual_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "merchant_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "merchant_token2",
      "value": "",
      "type": "string"
    },
    {
      "key": "admin_email",
      "value": "admin@example.com",
      "type": "string"
    },
    {
      "key": "admin_password",
      "value": "password123",
      "type": "string"
    },
    {
      "key": "agent_email",
      "value": "zioncrm222@gmail.com",
      "type": "string"
    },
    {
      "key": "agent_password",
      "value": "12345678",
      "type": "string"
    },
    {
      "key": "merchant_email",
      "value": "zizi1@gmail.com",
      "type": "string"
    },
    {
      "key": "merchant_password",
      "value": "123456",
      "type": "string"
    },
    {
      "key": "merchant_email2",
      "value": "zioncodeliba@gmail.com",
      "type": "string"
    },
    {
      "key": "merchant_password2",
      "value": "password123",
      "type": "string"
    },
    {
      "key": "password_reset_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "user_id",
      "value": "1",
      "type": "string"
    },
    {
      "key": "category_id",
      "value": "1",
      "type": "string"
    },
    {
      "key": "product_id",
      "value": "1",
      "type": "string"
    },
    {
      "key": "secondary_product_id",
      "value": "2",
      "type": "string"
    },
    {
      "key": "product_variation_id",
      "value": "1",
      "type": "string"
    },
    {
      "key": "secondary_product_variation_id",
      "value": "2",
      "type": "string"
    },
    {
      "key": "variant_product_id",
      "value": "1",
      "type": "string"
    },
    {
      "key": "order_id",
      "value": "1",
      "type": "string"
    },
    {
      "key": "order_status",
      "value": "pending",
      "type": "string"
    },
    {
      "key": "shipment_id",
      "value": "1",
      "type": "string"
    },
    {
      "key": "shipment_status",
      "value": "pending",
      "type": "string"
    },
    {
      "key": "customer_id",
      "value": "1",
      "type": "string"
    },
    {
      "key": "merchant_id",
      "value": "1",
      "type": "string"
    },
    {
      "key": "merchant_customer_id",
      "value": "1",
      "type": "string"
    },
    {
      "key": "shipping_carrier_id",
      "value": "1",
      "type": "string"
    },
    {
      "key": "plugin_site_id",
      "value": "1",
      "type": "string"
    },
    {
      "key": "plugin_site_url",
      "value": "https://business.facebook.com",
      "type": "string"
    },
    {
      "key": "plugin_site_url2",
      "value": "https://facebook.com",
      "type": "string"
    },
    {
      "key": "plugin_category_id",
      "value": "1",
      "type": "string"
    },
    {
      "key": "plugin_order_number",
      "value": "TEST-1001",
      "type": "string"
    },
    {
      "key": "tracking_number",
      "value": "TRACK12345",
      "type": "string"
    },
    {
      "key": "verification_hash",
      "value": "hash",
      "type": "string"
    },
    {
      "key": "image_path",
      "value": "products/sample.jpg",
      "type": "string"
    },
    {
      "key": "last_user_id",
      "value": "",
      "type": "string"
    }
  ]
}